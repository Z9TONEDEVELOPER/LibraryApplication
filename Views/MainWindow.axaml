<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:Models="clr-namespace:LibraryApp.Models"
        xmlns:Views="clr-namespace:LibraryApp.Views"
        x:DataType="Views:MainWindow"
        x:Class="LibraryApp.Views.MainWindow"
        x:Name="MainWindowRoot"
        Title="Читательский киоск"
        WindowState="FullScreen"
        Topmost="True"
        CanResize="False"
        ShowInTaskbar="False"
        >
    <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />   <!-- Header -->
      <RowDefinition Height="Auto" />   <!-- Меню-ссылки -->
      <RowDefinition Height="*" />      <!-- Ресурсы -->
      <RowDefinition Height="Auto" />   <!-- Программы -->
    </Grid.RowDefinitions>

    <!-- Header: баннер ЦБС -->
    <Image Source="avares://LibraryApp/Assets/Background/cbs_header.png"
           Grid.Row="0"
            Height="120"
            Stretch="Uniform"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Top"  />

    <!-- Меню-ссылки под баннером -->
    <ItemsControl Grid.Row="1"
              ItemsSource="{Binding Config.Header.MenuItems}"
              HorizontalAlignment="Center"
              Margin="0,8,0,12">
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
        <WrapPanel Orientation="Horizontal" />
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
    <ItemsControl.ItemTemplate>
        <DataTemplate x:DataType="Models:HeaderItem">
        <Button Content="{Binding Name}"
                Click="OnHeaderItemClick"
                Tag="{Binding Url}"
                Background="#4CAF50"
                Foreground="White"
                Padding="16,8"
                Margin="12,6"
                CornerRadius="8"
                FontSize="16"
                FontWeight="SemiBold"
                MinWidth="120" />
        </DataTemplate>
    </ItemsControl.ItemTemplate>
    </ItemsControl>
    <!-- Сетка ресурсов -->
    <ItemsControl x:Name="ResourceItemsControl"
                  Grid.Row="2"
                  Margin="60,20,60,20">
      <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
          <UniformGrid Columns="5" />
        </ItemsPanelTemplate>
      </ItemsControl.ItemsPanel>
      <ItemsControl.ItemTemplate>
        <DataTemplate x:DataType="Models:ResourceItem">
          <Button Content="{Binding Title}"
                  FontSize="16"
                  Padding="10"
                  Margin="8"
                  Background="White"
                  BorderBrush="#ccc"
                  BorderThickness="2"
                  CornerRadius="8"
                  HorizontalContentAlignment="Center"
                  VerticalContentAlignment="Center"
                  Width="140"
                  Height="120"
                  Click="OnResourceClick"
                  Tag="{Binding Url}" />
        </DataTemplate>
      </ItemsControl.ItemTemplate>
    </ItemsControl>

    <!-- Панель программ внизу -->
    <StackPanel Grid.Row="3"
                Orientation="Horizontal"
                HorizontalAlignment="Center"
                Margin="0,0,0,20">
      <ItemsControl x:Name="ProgramItemsControl">
        <ItemsControl.ItemsPanel>
          <ItemsPanelTemplate>
            <StackPanel Orientation="Horizontal" />
          </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
        <ItemsControl.ItemTemplate>
          <DataTemplate x:DataType="Models:ProgramItem">
            <Button Content="{Binding Name}"
                    Width="100"
                    Height="50"
                    Margin="5"
                    Click="OnProgramClick"
                    Tag="{Binding Path}" />
          </DataTemplate>
        </ItemsControl.ItemTemplate>
      </ItemsControl>
    </StackPanel>

    <!-- Секретная область для Dev Mode -->
    <Border x:Name="DevTrigger"
            Grid.RowSpan="4"
            Width="50"
            Height="50"
            HorizontalAlignment="Right"
            VerticalAlignment="Top"
            Background="Transparent"
            Cursor="Hand" />
  </Grid>
</Window>
